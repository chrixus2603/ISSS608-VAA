<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Chrissandro">
<meta name="dcterms.date" content="2024-03-06">

<title>Chrissandro’s VAA page - Take-home Exercise 4: Prototyping Modules for Visual Analytics Shiny Application</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/hiclipart.com.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="../../site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/hiclipart.com.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS608-VAA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Hands-on Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercises">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 1: A Layered Grammar of Graphics - ggplot2 methods</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 2: Beyond ggplot2 Fundamentals</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03a.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 3a: Programming Interactive Data Visualisation with R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03b.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 3b: Programming Animated Statistical Graphics with R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04a.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 4a: Visualising Distribution</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04b.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 4b: Visual Statistical Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04c.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 4c: Visualising Uncertainty</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04d.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 4d: Funnel Plots for Fair Comparisons</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05a.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5a: Creating Ternary Plot with R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05b.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5b: Visual Correlation Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05c.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5c: Heatmap for Visualising and Analysing Multivariate Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05d.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5d: Visual Multivariate Analysis with Parallel Coordinates Plot</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05e.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5e: Treemap Visualisation with R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 6: Visualising and Analysing Time-oriented Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07a.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 7a: Choropleth Mapping with R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07b.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 7b: Visualising Geospatial Point Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07c.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 7c: Analytical Mapping</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 8: Modelling, Visualising and Analysing Network Data with R</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">In-class Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercises">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex06/In-class_Ex06.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 6</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Take-home Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercises">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex04/Take-home_Ex04.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 4</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-group-project" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Group Project</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-group-project">    
        <li class="dropdown-header">Part I: Prototyping</li>
        <li>
    <a class="dropdown-item" href="../../Project/Prototype/Part01_Prototype.html" rel="" target="">
 <span class="dropdown-text"></span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">Data Preparation</a>
  <ul class="collapse">
  <li><a href="#installing-and-launching-packages" id="toc-installing-and-launching-packages" class="nav-link" data-scroll-target="#installing-and-launching-packages">Installing and launching packages</a></li>
  <li><a href="#importing-data" id="toc-importing-data" class="nav-link" data-scroll-target="#importing-data">Importing data</a></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">Data Wrangling</a></li>
  </ul></li>
  <li><a href="#data-visualization" id="toc-data-visualization" class="nav-link" data-scroll-target="#data-visualization">Data Visualization</a></li>
  <li><a href="#time-series-analysis-and-nowcasting" id="toc-time-series-analysis-and-nowcasting" class="nav-link" data-scroll-target="#time-series-analysis-and-nowcasting">Time Series Analysis and Nowcasting</a>
  <ul class="collapse">
  <li><a href="#nowcasting-model-linear-regression-simple" id="toc-nowcasting-model-linear-regression-simple" class="nav-link" data-scroll-target="#nowcasting-model-linear-regression-simple">Nowcasting Model: Linear Regression (Simple)</a></li>
  <li><a href="#nowcasting-model-arima-autoregressive-integrated-moving-average" id="toc-nowcasting-model-arima-autoregressive-integrated-moving-average" class="nav-link" data-scroll-target="#nowcasting-model-arima-autoregressive-integrated-moving-average">Nowcasting Model: ARIMA (Autoregressive Integrated Moving Average)</a>
  <ul class="collapse">
  <li><a href="#converting-dataframe-to-time-series" id="toc-converting-dataframe-to-time-series" class="nav-link" data-scroll-target="#converting-dataframe-to-time-series">Converting Dataframe to Time Series</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#shiny-storyboarding" id="toc-shiny-storyboarding" class="nav-link" data-scroll-target="#shiny-storyboarding">Shiny Storyboarding</a>
  <ul class="collapse">
  <li><a href="#section-1-historical" id="toc-section-1-historical" class="nav-link" data-scroll-target="#section-1-historical">Section 1: Historical</a>
  <ul class="collapse">
  <li><a href="#ui-components" id="toc-ui-components" class="nav-link" data-scroll-target="#ui-components">UI Components</a></li>
  <li><a href="#server-design" id="toc-server-design" class="nav-link" data-scroll-target="#server-design">Server Design</a></li>
  </ul></li>
  <li><a href="#section-2-nowcasting" id="toc-section-2-nowcasting" class="nav-link" data-scroll-target="#section-2-nowcasting">Section 2: Nowcasting</a>
  <ul class="collapse">
  <li><a href="#ui-components-1" id="toc-ui-components-1" class="nav-link" data-scroll-target="#ui-components-1">UI Components</a></li>
  <li><a href="#server-logic" id="toc-server-logic" class="nav-link" data-scroll-target="#server-logic">Server Logic</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-home Exercise 4: Prototyping Modules for Visual Analytics Shiny Application</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Chrissandro </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 6, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">March 15, 2024</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="overview" class="level1">
<h1>Overview</h1>
<p>For this take-home exercise, I am tasked with prototyping key modules for the R Shiny application that is poised to serve as an integral component of our group project. The initial stages of this exercise are dedicated to data preparation and the providing some insightful data visualizations. This foundational work is essential for setting the stage for subsequent nowcasting analyses of selected datasets as aligned with our project topic <strong>‘Discovering State of Economic in Singapore with Nowcasting Methods’</strong>.</p>
<p>Following that, the design and development of the user interface (UI) for the R Shiny web application will also be provided. This phase is geared towards ensuring that the application is not only functional but also intuitive and engaging for users, thereby enhancing the overall effectiveness and accessibility of the data insights generated by our group project.</p>
</section>
<section id="data-preparation" class="level1">
<h1>Data Preparation</h1>
<section id="installing-and-launching-packages" class="level2">
<h2 class="anchored" data-anchor-id="installing-and-launching-packages">Installing and launching packages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, forecast, tseries, ggplot2, plotly, zoo, patchwork)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importing-data" class="level2">
<h2 class="anchored" data-anchor-id="importing-data">Importing data</h2>
<p>The datasets used in this exercise can be found <a href="https://insights-ceicdata-com.libproxy.smu.edu.sg">here</a>.</p>
<p>Two of the datasets used in our final group projects are as listed:</p>
<ul>
<li>Retail Sales Value</li>
<li>Food and Beverage Sales Value</li>
</ul>
<p>The datasets have been cleaned to show the date and mean sales value per month.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Retail Sales</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Food &amp; Beverage Sales</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>salesdata <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Data/Retail Sales Value 2017100.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(salesdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [325 × 2] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ Date : chr [1:325] "01/1997" "02/1997" "03/1997" "04/1997" ...
 $ Value: num [1:325] 2656 1703 2027 1934 1961 ...
 - attr(*, "spec")=
  .. cols(
  ..   Date = col_character(),
  ..   Value = col_double()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>fnbdata <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Data/Food and Beverage Services Value 2017100.csv"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(fnbdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [325 × 2] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ Date : chr [1:325] "01/1997" "02/1997" "03/1997" "04/1997" ...
 $ Value: num [1:325] 288 284 306 279 294 299 288 289 299 293 ...
 - attr(*, "spec")=
  .. cols(
  ..   Date = col_character(),
  ..   Value = col_double()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="data-wrangling">Data Wrangling</h2>
<p>The “DATE” column in the format ‘MM/YYYY’ needs to be converted into a <em>Date</em> type that R can recognize for time series analysis. However, since the data represents monthly data without specific days, we’ll create a date that represents the first day of each month for consistency.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>start_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">'2000-01-01'</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>salesdata<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(<span class="st">"01/"</span>, salesdata<span class="sc">$</span>Date), <span class="at">format=</span><span class="st">"%d/%m/%Y"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>salesdata <span class="ot">&lt;-</span> salesdata[salesdata<span class="sc">$</span>Date <span class="sc">&gt;=</span> start_date, ]</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>fnbdata<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(<span class="st">"01/"</span>, fnbdata<span class="sc">$</span>Date), <span class="at">format=</span><span class="st">"%d/%m/%Y"</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>fnbdata <span class="ot">&lt;-</span> fnbdata[fnbdata<span class="sc">$</span>Date <span class="sc">&gt;=</span> start_date, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s convert the Date column to <em>Yearmon</em> value for better readability of the date. The <em>range</em> function will verify the start and end date of the dataset we’re going to use.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>salesdata<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.yearmon</span>(salesdata<span class="sc">$</span>Date)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>fnbdata<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.yearmon</span>(fnbdata<span class="sc">$</span>Date)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(salesdata<span class="sc">$</span>Date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Jan 2000" "Jan 2024"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(fnbdata<span class="sc">$</span>Date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Jan 2000" "Jan 2024"</code></pre>
</div>
</div>
</section>
</section>
<section id="data-visualization" class="level1">
<h1>Data Visualization</h1>
<p>Using <strong>ggplot2</strong>, the sales value will be visualized as seen below and <strong>plotly</strong> package is used to provide interactivity to the chart below to provide detailed information of specific data points.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Retail Sales</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Food and Beverage Sales</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(<span class="fu">ggplot</span>(salesdata, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Retail Sales Value From Jan 2000-Jan 2024"</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sales (SGD)"</span>) <span class="sc">+</span> </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-b302915eaa2254eb7877" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-b302915eaa2254eb7877">{"x":{"data":[{"x":[2000,2000.0833333333333,2000.1666666666667,2000.25,2000.3333333333333,2000.4166666666667,2000.5,2000.5833333333333,2000.6666666666667,2000.75,2000.8333333333333,2000.9166666666667,2001,2001.0833333333333,2001.1666666666667,2001.25,2001.3333333333333,2001.4166666666667,2001.5,2001.5833333333333,2001.6666666666667,2001.75,2001.8333333333333,2001.9166666666667,2002,2002.0833333333333,2002.1666666666667,2002.25,2002.3333333333333,2002.4166666666667,2002.5,2002.5833333333333,2002.6666666666667,2002.75,2002.8333333333333,2002.9166666666667,2003,2003.0833333333333,2003.1666666666667,2003.25,2003.3333333333333,2003.4166666666667,2003.5,2003.5833333333333,2003.6666666666667,2003.75,2003.8333333333333,2003.9166666666667,2004,2004.0833333333333,2004.1666666666667,2004.25,2004.3333333333333,2004.4166666666667,2004.5,2004.5833333333333,2004.6666666666667,2004.75,2004.8333333333333,2004.9166666666667,2005,2005.0833333333333,2005.1666666666667,2005.25,2005.3333333333333,2005.4166666666667,2005.5,2005.5833333333333,2005.6666666666667,2005.75,2005.8333333333333,2005.9166666666667,2006,2006.0833333333333,2006.1666666666667,2006.25,2006.3333333333333,2006.4166666666667,2006.5,2006.5833333333333,2006.6666666666667,2006.75,2006.8333333333333,2006.9166666666667,2007,2007.0833333333333,2007.1666666666667,2007.25,2007.3333333333333,2007.4166666666667,2007.5,2007.5833333333333,2007.6666666666667,2007.75,2007.8333333333333,2007.9166666666667,2008,2008.0833333333333,2008.1666666666667,2008.25,2008.3333333333333,2008.4166666666667,2008.5,2008.5833333333333,2008.6666666666667,2008.75,2008.8333333333333,2008.9166666666667,2009,2009.0833333333333,2009.1666666666667,2009.25,2009.3333333333333,2009.4166666666667,2009.5,2009.5833333333333,2009.6666666666667,2009.75,2009.8333333333333,2009.9166666666667,2010,2010.0833333333333,2010.1666666666667,2010.25,2010.3333333333333,2010.4166666666667,2010.5,2010.5833333333333,2010.6666666666667,2010.75,2010.8333333333333,2010.9166666666667,2011,2011.0833333333333,2011.1666666666667,2011.25,2011.3333333333333,2011.4166666666667,2011.5,2011.5833333333333,2011.6666666666667,2011.75,2011.8333333333333,2011.9166666666667,2012,2012.0833333333333,2012.1666666666667,2012.25,2012.3333333333333,2012.4166666666667,2012.5,2012.5833333333333,2012.6666666666667,2012.75,2012.8333333333333,2012.9166666666667,2013,2013.0833333333333,2013.1666666666667,2013.25,2013.3333333333333,2013.4166666666667,2013.5,2013.5833333333333,2013.6666666666667,2013.75,2013.8333333333333,2013.9166666666667,2014,2014.0833333333333,2014.1666666666667,2014.25,2014.3333333333333,2014.4166666666667,2014.5,2014.5833333333333,2014.6666666666667,2014.75,2014.8333333333333,2014.9166666666667,2015,2015.0833333333333,2015.1666666666667,2015.25,2015.3333333333333,2015.4166666666667,2015.5,2015.5833333333333,2015.6666666666667,2015.75,2015.8333333333333,2015.9166666666667,2016,2016.0833333333333,2016.1666666666667,2016.25,2016.3333333333333,2016.4166666666667,2016.5,2016.5833333333333,2016.6666666666667,2016.75,2016.8333333333333,2016.9166666666667,2017,2017.0833333333333,2017.1666666666667,2017.25,2017.3333333333333,2017.4166666666667,2017.5,2017.5833333333333,2017.6666666666667,2017.75,2017.8333333333333,2017.9166666666667,2018,2018.0833333333333,2018.1666666666667,2018.25,2018.3333333333333,2018.4166666666667,2018.5,2018.5833333333333,2018.6666666666667,2018.75,2018.8333333333333,2018.9166666666667,2019,2019.0833333333333,2019.1666666666667,2019.25,2019.3333333333333,2019.4166666666667,2019.5,2019.5833333333333,2019.6666666666667,2019.75,2019.8333333333333,2019.9166666666667,2020,2020.0833333333333,2020.1666666666667,2020.25,2020.3333333333333,2020.4166666666667,2020.5,2020.5833333333333,2020.6666666666667,2020.75,2020.8333333333333,2020.9166666666667,2021,2021.0833333333333,2021.1666666666667,2021.25,2021.3333333333333,2021.4166666666667,2021.5,2021.5833333333333,2021.6666666666667,2021.75,2021.8333333333333,2021.9166666666667,2022,2022.0833333333333,2022.1666666666667,2022.25,2022.3333333333333,2022.4166666666667,2022.5,2022.5833333333333,2022.6666666666667,2022.75,2022.8333333333333,2022.9166666666667,2023,2023.0833333333333,2023.1666666666667,2023.25,2023.3333333333333,2023.4166666666667,2023.5,2023.5833333333333,2023.6666666666667,2023.75,2023.8333333333333,2023.9166666666667,2024],"y":[2383,1565,1909,1914,1952,2117,2098,1925,2005,1796,2002,2240,2252,1696,2042,1793,1846,1850,1797,1870,1691,1698,1822,2111,2090,1665,2019,1822,1766,1835,1973,1846,1793,1835,1977,2388,2421,1565,1930,1831,2029,1946,2072,1890,1940,1998,2082,2510,2442,2106,2248,2053,2138,2242,2214,2064,2131,2262,2330,2612,2778,2078,2558,2350,2363,2486,2516,2341,2425,2599,2450,2914,3016,2181,2858,2545,2697,2622,2615,2425,2513,2657,2681,3094,3044,2640,2773,2619,2813,3079,2619,2645,2744,2838,2741,3239,3342,2642,2954,2844,2986,3001,2958,2797,2999,2812,2742,3335,3076,2616,2893,2664,2828,2904,2828,2817,2786,2821,2826,3306,3174,2733,2877,2658,2726,2764,2845,2848,2896,2896,2979,3552,3441,2553,3071,3063,3187,3275,3362,3138,3072,3329,3316,3865,3660,3165,3443,3214,3279,3315,3331,3324,3232,3379,3374,3941,3730,3226,3362,3389,3585,3383,3261,3272,3234,3243,3266,3935,4028,3081,3494,3237,3461,3424,3450,3451,3350,3537,3482,4119,3800,3499,3526,3353,3610,3613,3574,3626,3448,3603,3624,4223,4110,3435,3754,3513,3783,3734,3746,3676,3578,3740,3707,4306,4270,3386,3847,3543,3791,3783,3775,3774,3548,3735,3892,4569,3948,3676,3813,3591,3808,3863,3697,3777,3631,3773,3841,4331,4286,3351,3828,3565,3778,3556,3674,3648,3583,3638,3701,4210,4022,3090,3329,2156,1840,2594,3384,3473,3238,3369,3699,4137,3827,3322,3609,3397,3398,3354,3462,3450,3519,3681,3831,4455,4319,3213,3931,3800,3994,3835,3926,3877,3881,4039,4055,4767,4238,3591,4082,3920,4049,3865,3976,4041,3906,4021,4137,4745,4294],"text":["Date: Jan 2000<br />Value: 2383","Date: Feb 2000<br />Value: 1565","Date: Mar 2000<br />Value: 1909","Date: Apr 2000<br />Value: 1914","Date: May 2000<br />Value: 1952","Date: Jun 2000<br />Value: 2117","Date: Jul 2000<br />Value: 2098","Date: Aug 2000<br />Value: 1925","Date: Sep 2000<br />Value: 2005","Date: Oct 2000<br />Value: 1796","Date: Nov 2000<br />Value: 2002","Date: Dec 2000<br />Value: 2240","Date: Jan 2001<br />Value: 2252","Date: Feb 2001<br />Value: 1696","Date: Mar 2001<br />Value: 2042","Date: Apr 2001<br />Value: 1793","Date: May 2001<br />Value: 1846","Date: Jun 2001<br />Value: 1850","Date: Jul 2001<br />Value: 1797","Date: Aug 2001<br />Value: 1870","Date: Sep 2001<br />Value: 1691","Date: Oct 2001<br />Value: 1698","Date: Nov 2001<br />Value: 1822","Date: Dec 2001<br />Value: 2111","Date: Jan 2002<br />Value: 2090","Date: Feb 2002<br />Value: 1665","Date: Mar 2002<br />Value: 2019","Date: Apr 2002<br />Value: 1822","Date: May 2002<br />Value: 1766","Date: Jun 2002<br />Value: 1835","Date: Jul 2002<br />Value: 1973","Date: Aug 2002<br />Value: 1846","Date: Sep 2002<br />Value: 1793","Date: Oct 2002<br />Value: 1835","Date: Nov 2002<br />Value: 1977","Date: Dec 2002<br />Value: 2388","Date: Jan 2003<br />Value: 2421","Date: Feb 2003<br />Value: 1565","Date: Mar 2003<br />Value: 1930","Date: Apr 2003<br />Value: 1831","Date: May 2003<br />Value: 2029","Date: Jun 2003<br />Value: 1946","Date: Jul 2003<br />Value: 2072","Date: Aug 2003<br />Value: 1890","Date: Sep 2003<br />Value: 1940","Date: Oct 2003<br />Value: 1998","Date: Nov 2003<br />Value: 2082","Date: Dec 2003<br />Value: 2510","Date: Jan 2004<br />Value: 2442","Date: Feb 2004<br />Value: 2106","Date: Mar 2004<br />Value: 2248","Date: Apr 2004<br />Value: 2053","Date: May 2004<br />Value: 2138","Date: Jun 2004<br />Value: 2242","Date: Jul 2004<br />Value: 2214","Date: Aug 2004<br />Value: 2064","Date: Sep 2004<br />Value: 2131","Date: Oct 2004<br />Value: 2262","Date: Nov 2004<br />Value: 2330","Date: Dec 2004<br />Value: 2612","Date: Jan 2005<br />Value: 2778","Date: Feb 2005<br />Value: 2078","Date: Mar 2005<br />Value: 2558","Date: Apr 2005<br />Value: 2350","Date: May 2005<br />Value: 2363","Date: Jun 2005<br />Value: 2486","Date: Jul 2005<br />Value: 2516","Date: Aug 2005<br />Value: 2341","Date: Sep 2005<br />Value: 2425","Date: Oct 2005<br />Value: 2599","Date: Nov 2005<br />Value: 2450","Date: Dec 2005<br />Value: 2914","Date: Jan 2006<br />Value: 3016","Date: Feb 2006<br />Value: 2181","Date: Mar 2006<br />Value: 2858","Date: Apr 2006<br />Value: 2545","Date: May 2006<br />Value: 2697","Date: Jun 2006<br />Value: 2622","Date: Jul 2006<br />Value: 2615","Date: Aug 2006<br />Value: 2425","Date: Sep 2006<br />Value: 2513","Date: Oct 2006<br />Value: 2657","Date: Nov 2006<br />Value: 2681","Date: Dec 2006<br />Value: 3094","Date: Jan 2007<br />Value: 3044","Date: Feb 2007<br />Value: 2640","Date: Mar 2007<br />Value: 2773","Date: Apr 2007<br />Value: 2619","Date: May 2007<br />Value: 2813","Date: Jun 2007<br />Value: 3079","Date: Jul 2007<br />Value: 2619","Date: Aug 2007<br />Value: 2645","Date: Sep 2007<br />Value: 2744","Date: Oct 2007<br />Value: 2838","Date: Nov 2007<br />Value: 2741","Date: Dec 2007<br />Value: 3239","Date: Jan 2008<br />Value: 3342","Date: Feb 2008<br />Value: 2642","Date: Mar 2008<br />Value: 2954","Date: Apr 2008<br />Value: 2844","Date: May 2008<br />Value: 2986","Date: Jun 2008<br />Value: 3001","Date: Jul 2008<br />Value: 2958","Date: Aug 2008<br />Value: 2797","Date: Sep 2008<br />Value: 2999","Date: Oct 2008<br />Value: 2812","Date: Nov 2008<br />Value: 2742","Date: Dec 2008<br />Value: 3335","Date: Jan 2009<br />Value: 3076","Date: Feb 2009<br />Value: 2616","Date: Mar 2009<br />Value: 2893","Date: Apr 2009<br />Value: 2664","Date: May 2009<br />Value: 2828","Date: Jun 2009<br />Value: 2904","Date: Jul 2009<br />Value: 2828","Date: Aug 2009<br />Value: 2817","Date: Sep 2009<br />Value: 2786","Date: Oct 2009<br />Value: 2821","Date: Nov 2009<br />Value: 2826","Date: Dec 2009<br />Value: 3306","Date: Jan 2010<br />Value: 3174","Date: Feb 2010<br />Value: 2733","Date: Mar 2010<br />Value: 2877","Date: Apr 2010<br />Value: 2658","Date: May 2010<br />Value: 2726","Date: Jun 2010<br />Value: 2764","Date: Jul 2010<br />Value: 2845","Date: Aug 2010<br />Value: 2848","Date: Sep 2010<br />Value: 2896","Date: Oct 2010<br />Value: 2896","Date: Nov 2010<br />Value: 2979","Date: Dec 2010<br />Value: 3552","Date: Jan 2011<br />Value: 3441","Date: Feb 2011<br />Value: 2553","Date: Mar 2011<br />Value: 3071","Date: Apr 2011<br />Value: 3063","Date: May 2011<br />Value: 3187","Date: Jun 2011<br />Value: 3275","Date: Jul 2011<br />Value: 3362","Date: Aug 2011<br />Value: 3138","Date: Sep 2011<br />Value: 3072","Date: Oct 2011<br />Value: 3329","Date: Nov 2011<br />Value: 3316","Date: Dec 2011<br />Value: 3865","Date: Jan 2012<br />Value: 3660","Date: Feb 2012<br />Value: 3165","Date: Mar 2012<br />Value: 3443","Date: Apr 2012<br />Value: 3214","Date: May 2012<br />Value: 3279","Date: Jun 2012<br />Value: 3315","Date: Jul 2012<br />Value: 3331","Date: Aug 2012<br />Value: 3324","Date: Sep 2012<br />Value: 3232","Date: Oct 2012<br />Value: 3379","Date: Nov 2012<br />Value: 3374","Date: Dec 2012<br />Value: 3941","Date: Jan 2013<br />Value: 3730","Date: Feb 2013<br />Value: 3226","Date: Mar 2013<br />Value: 3362","Date: Apr 2013<br />Value: 3389","Date: May 2013<br />Value: 3585","Date: Jun 2013<br />Value: 3383","Date: Jul 2013<br />Value: 3261","Date: Aug 2013<br />Value: 3272","Date: Sep 2013<br />Value: 3234","Date: Oct 2013<br />Value: 3243","Date: Nov 2013<br />Value: 3266","Date: Dec 2013<br />Value: 3935","Date: Jan 2014<br />Value: 4028","Date: Feb 2014<br />Value: 3081","Date: Mar 2014<br />Value: 3494","Date: Apr 2014<br />Value: 3237","Date: May 2014<br />Value: 3461","Date: Jun 2014<br />Value: 3424","Date: Jul 2014<br />Value: 3450","Date: Aug 2014<br />Value: 3451","Date: Sep 2014<br />Value: 3350","Date: Oct 2014<br />Value: 3537","Date: Nov 2014<br />Value: 3482","Date: Dec 2014<br />Value: 4119","Date: Jan 2015<br />Value: 3800","Date: Feb 2015<br />Value: 3499","Date: Mar 2015<br />Value: 3526","Date: Apr 2015<br />Value: 3353","Date: May 2015<br />Value: 3610","Date: Jun 2015<br />Value: 3613","Date: Jul 2015<br />Value: 3574","Date: Aug 2015<br />Value: 3626","Date: Sep 2015<br />Value: 3448","Date: Oct 2015<br />Value: 3603","Date: Nov 2015<br />Value: 3624","Date: Dec 2015<br />Value: 4223","Date: Jan 2016<br />Value: 4110","Date: Feb 2016<br />Value: 3435","Date: Mar 2016<br />Value: 3754","Date: Apr 2016<br />Value: 3513","Date: May 2016<br />Value: 3783","Date: Jun 2016<br />Value: 3734","Date: Jul 2016<br />Value: 3746","Date: Aug 2016<br />Value: 3676","Date: Sep 2016<br />Value: 3578","Date: Oct 2016<br />Value: 3740","Date: Nov 2016<br />Value: 3707","Date: Dec 2016<br />Value: 4306","Date: Jan 2017<br />Value: 4270","Date: Feb 2017<br />Value: 3386","Date: Mar 2017<br />Value: 3847","Date: Apr 2017<br />Value: 3543","Date: May 2017<br />Value: 3791","Date: Jun 2017<br />Value: 3783","Date: Jul 2017<br />Value: 3775","Date: Aug 2017<br />Value: 3774","Date: Sep 2017<br />Value: 3548","Date: Oct 2017<br />Value: 3735","Date: Nov 2017<br />Value: 3892","Date: Dec 2017<br />Value: 4569","Date: Jan 2018<br />Value: 3948","Date: Feb 2018<br />Value: 3676","Date: Mar 2018<br />Value: 3813","Date: Apr 2018<br />Value: 3591","Date: May 2018<br />Value: 3808","Date: Jun 2018<br />Value: 3863","Date: Jul 2018<br />Value: 3697","Date: Aug 2018<br />Value: 3777","Date: Sep 2018<br />Value: 3631","Date: Oct 2018<br />Value: 3773","Date: Nov 2018<br />Value: 3841","Date: Dec 2018<br />Value: 4331","Date: Jan 2019<br />Value: 4286","Date: Feb 2019<br />Value: 3351","Date: Mar 2019<br />Value: 3828","Date: Apr 2019<br />Value: 3565","Date: May 2019<br />Value: 3778","Date: Jun 2019<br />Value: 3556","Date: Jul 2019<br />Value: 3674","Date: Aug 2019<br />Value: 3648","Date: Sep 2019<br />Value: 3583","Date: Oct 2019<br />Value: 3638","Date: Nov 2019<br />Value: 3701","Date: Dec 2019<br />Value: 4210","Date: Jan 2020<br />Value: 4022","Date: Feb 2020<br />Value: 3090","Date: Mar 2020<br />Value: 3329","Date: Apr 2020<br />Value: 2156","Date: May 2020<br />Value: 1840","Date: Jun 2020<br />Value: 2594","Date: Jul 2020<br />Value: 3384","Date: Aug 2020<br />Value: 3473","Date: Sep 2020<br />Value: 3238","Date: Oct 2020<br />Value: 3369","Date: Nov 2020<br />Value: 3699","Date: Dec 2020<br />Value: 4137","Date: Jan 2021<br />Value: 3827","Date: Feb 2021<br />Value: 3322","Date: Mar 2021<br />Value: 3609","Date: Apr 2021<br />Value: 3397","Date: May 2021<br />Value: 3398","Date: Jun 2021<br />Value: 3354","Date: Jul 2021<br />Value: 3462","Date: Aug 2021<br />Value: 3450","Date: Sep 2021<br />Value: 3519","Date: Oct 2021<br />Value: 3681","Date: Nov 2021<br />Value: 3831","Date: Dec 2021<br />Value: 4455","Date: Jan 2022<br />Value: 4319","Date: Feb 2022<br />Value: 3213","Date: Mar 2022<br />Value: 3931","Date: Apr 2022<br />Value: 3800","Date: May 2022<br />Value: 3994","Date: Jun 2022<br />Value: 3835","Date: Jul 2022<br />Value: 3926","Date: Aug 2022<br />Value: 3877","Date: Sep 2022<br />Value: 3881","Date: Oct 2022<br />Value: 4039","Date: Nov 2022<br />Value: 4055","Date: Dec 2022<br />Value: 4767","Date: Jan 2023<br />Value: 4238","Date: Feb 2023<br />Value: 3591","Date: Mar 2023<br />Value: 4082","Date: Apr 2023<br />Value: 3920","Date: May 2023<br />Value: 4049","Date: Jun 2023<br />Value: 3865","Date: Jul 2023<br />Value: 3976","Date: Aug 2023<br />Value: 4041","Date: Sep 2023<br />Value: 3906","Date: Oct 2023<br />Value: 4021","Date: Nov 2023<br />Value: 4137","Date: Dec 2023<br />Value: 4745","Date: Jan 2024<br />Value: 4294"],"type":"scatter","mode":"lines+markers","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":3.7795275590551185,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826498,"l":48.949771689497723},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Retail Sales Value From Jan 2000-Jan 2024","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1998.8,2025.2],"tickmode":"array","ticktext":["Jan 2000","Jan 2005","Jan 2010","Jan 2015","Jan 2020","Jan 2025"],"tickvals":[2000,2005,2010,2015,2020,2025],"categoryorder":"array","categoryarray":["Jan 2000","Jan 2005","Jan 2010","Jan 2015","Jan 2020","Jan 2025"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Date","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1404.9000000000001,4927.1000000000004],"tickmode":"array","ticktext":["2000","3000","4000"],"tickvals":[2000,3000,4000],"categoryorder":"array","categoryarray":["2000","3000","4000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Sales (SGD)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"64755e62bcc8":{"x":{},"y":{},"type":"scatter"},"647524581ee1":{"x":{},"y":{}}},"cur_data":"64755e62bcc8","visdat":{"64755e62bcc8":["function (y) ","x"],"647524581ee1":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Visualization Insights:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p><strong>Trend</strong>: The trend is showing a definite increase in retail sales value for the past 20+ years as time progresses, so it is safe to assume from the trends that retail sales are going to always increase in the future disregarding external factors that might divert that assumption.</p></li>
<li><p><strong>Seasonality</strong>: From the line chart above, it can be observed that for the month of February of every year shows a downward spike of retail sales. This might indicate seasonality or predictable changes for a specific time, which in this case is highly likely caused by <strong>Lunar New Year celebrations</strong> which is celebrated by majority of Singapore’s populations.</p></li>
<li><p><strong>Outlier</strong>: An outlier can be seen during the COVID period of early 2020s to the end of 2021 where retail sales value spikes all the way down by more than 50%.</p></li>
</ul>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(<span class="fu">ggplot</span>(fnbdata, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Food and Beverage Sales Value From Jan 2000-Jan 2024"</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sales (SGD)"</span>) <span class="sc">+</span> </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-98a76adacc4681436169" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-98a76adacc4681436169">{"x":{"data":[{"x":[2000,2000.0833333333333,2000.1666666666667,2000.25,2000.3333333333333,2000.4166666666667,2000.5,2000.5833333333333,2000.6666666666667,2000.75,2000.8333333333333,2000.9166666666667,2001,2001.0833333333333,2001.1666666666667,2001.25,2001.3333333333333,2001.4166666666667,2001.5,2001.5833333333333,2001.6666666666667,2001.75,2001.8333333333333,2001.9166666666667,2002,2002.0833333333333,2002.1666666666667,2002.25,2002.3333333333333,2002.4166666666667,2002.5,2002.5833333333333,2002.6666666666667,2002.75,2002.8333333333333,2002.9166666666667,2003,2003.0833333333333,2003.1666666666667,2003.25,2003.3333333333333,2003.4166666666667,2003.5,2003.5833333333333,2003.6666666666667,2003.75,2003.8333333333333,2003.9166666666667,2004,2004.0833333333333,2004.1666666666667,2004.25,2004.3333333333333,2004.4166666666667,2004.5,2004.5833333333333,2004.6666666666667,2004.75,2004.8333333333333,2004.9166666666667,2005,2005.0833333333333,2005.1666666666667,2005.25,2005.3333333333333,2005.4166666666667,2005.5,2005.5833333333333,2005.6666666666667,2005.75,2005.8333333333333,2005.9166666666667,2006,2006.0833333333333,2006.1666666666667,2006.25,2006.3333333333333,2006.4166666666667,2006.5,2006.5833333333333,2006.6666666666667,2006.75,2006.8333333333333,2006.9166666666667,2007,2007.0833333333333,2007.1666666666667,2007.25,2007.3333333333333,2007.4166666666667,2007.5,2007.5833333333333,2007.6666666666667,2007.75,2007.8333333333333,2007.9166666666667,2008,2008.0833333333333,2008.1666666666667,2008.25,2008.3333333333333,2008.4166666666667,2008.5,2008.5833333333333,2008.6666666666667,2008.75,2008.8333333333333,2008.9166666666667,2009,2009.0833333333333,2009.1666666666667,2009.25,2009.3333333333333,2009.4166666666667,2009.5,2009.5833333333333,2009.6666666666667,2009.75,2009.8333333333333,2009.9166666666667,2010,2010.0833333333333,2010.1666666666667,2010.25,2010.3333333333333,2010.4166666666667,2010.5,2010.5833333333333,2010.6666666666667,2010.75,2010.8333333333333,2010.9166666666667,2011,2011.0833333333333,2011.1666666666667,2011.25,2011.3333333333333,2011.4166666666667,2011.5,2011.5833333333333,2011.6666666666667,2011.75,2011.8333333333333,2011.9166666666667,2012,2012.0833333333333,2012.1666666666667,2012.25,2012.3333333333333,2012.4166666666667,2012.5,2012.5833333333333,2012.6666666666667,2012.75,2012.8333333333333,2012.9166666666667,2013,2013.0833333333333,2013.1666666666667,2013.25,2013.3333333333333,2013.4166666666667,2013.5,2013.5833333333333,2013.6666666666667,2013.75,2013.8333333333333,2013.9166666666667,2014,2014.0833333333333,2014.1666666666667,2014.25,2014.3333333333333,2014.4166666666667,2014.5,2014.5833333333333,2014.6666666666667,2014.75,2014.8333333333333,2014.9166666666667,2015,2015.0833333333333,2015.1666666666667,2015.25,2015.3333333333333,2015.4166666666667,2015.5,2015.5833333333333,2015.6666666666667,2015.75,2015.8333333333333,2015.9166666666667,2016,2016.0833333333333,2016.1666666666667,2016.25,2016.3333333333333,2016.4166666666667,2016.5,2016.5833333333333,2016.6666666666667,2016.75,2016.8333333333333,2016.9166666666667,2017,2017.0833333333333,2017.1666666666667,2017.25,2017.3333333333333,2017.4166666666667,2017.5,2017.5833333333333,2017.6666666666667,2017.75,2017.8333333333333,2017.9166666666667,2018,2018.0833333333333,2018.1666666666667,2018.25,2018.3333333333333,2018.4166666666667,2018.5,2018.5833333333333,2018.6666666666667,2018.75,2018.8333333333333,2018.9166666666667,2019,2019.0833333333333,2019.1666666666667,2019.25,2019.3333333333333,2019.4166666666667,2019.5,2019.5833333333333,2019.6666666666667,2019.75,2019.8333333333333,2019.9166666666667,2020,2020.0833333333333,2020.1666666666667,2020.25,2020.3333333333333,2020.4166666666667,2020.5,2020.5833333333333,2020.6666666666667,2020.75,2020.8333333333333,2020.9166666666667,2021,2021.0833333333333,2021.1666666666667,2021.25,2021.3333333333333,2021.4166666666667,2021.5,2021.5833333333333,2021.6666666666667,2021.75,2021.8333333333333,2021.9166666666667,2022,2022.0833333333333,2022.1666666666667,2022.25,2022.3333333333333,2022.4166666666667,2022.5,2022.5833333333333,2022.6666666666667,2022.75,2022.8333333333333,2022.9166666666667,2023,2023.0833333333333,2023.1666666666667,2023.25,2023.3333333333333,2023.4166666666667,2023.5,2023.5833333333333,2023.6666666666667,2023.75,2023.8333333333333,2023.9166666666667,2024],"y":[294,292,307,297,318,309,312,309,337,324,334,359,319,293,316,284,305,300,296,292,290,286,293,324,288,296,322,290,310,304,303,305,320,316,319,353,320,298,313,223,257,274,284,298,312,326,324,345,321,305,315,292,313,308,313,295,321,325,320,356,330,333,333,319,339,335,351,350,337,337,344,390,363,366,361,351,374,363,379,374,366,376,379,421,378,384,400,375,400,411,412,421,408,415,420,473,417,448,436,420,458,444,456,459,452,481,471,510,486,440,470,458,487,481,490,501,490,509,502,564,527,531,530,528,568,547,564,561,561,590,580,639,613,601,611,610,650,647,672,645,648,674,668,740,734,670,712,699,721,726,734,726,716,732,729,792,735,740,768,735,768,780,773,772,763,778,774,840,836,777,802,772,830,803,807,857,811,849,824,889,827,829,819,779,827,781,818,844,808,835,807,858,844,843,832,816,856,807,873,846,860,865,818,877,931,839,839,813,828,800,859,861,850,860,842,906,834,898,887,824,857,845,874,910,870,877,873,947,889,883,893,847,867,885,900,944,913,926,937,993,1007,767,720,428,453,531,724,729,694,747,760,860,776,754,784,743,658,562,667,666,708,694,743,896,826,731,801,811,902,878,931,918,902,938,920,1007,999,881,935,928,976,938,988,994,963,959,934,1011,942],"text":["Date: Jan 2000<br />Value:  294","Date: Feb 2000<br />Value:  292","Date: Mar 2000<br />Value:  307","Date: Apr 2000<br />Value:  297","Date: May 2000<br />Value:  318","Date: Jun 2000<br />Value:  309","Date: Jul 2000<br />Value:  312","Date: Aug 2000<br />Value:  309","Date: Sep 2000<br />Value:  337","Date: Oct 2000<br />Value:  324","Date: Nov 2000<br />Value:  334","Date: Dec 2000<br />Value:  359","Date: Jan 2001<br />Value:  319","Date: Feb 2001<br />Value:  293","Date: Mar 2001<br />Value:  316","Date: Apr 2001<br />Value:  284","Date: May 2001<br />Value:  305","Date: Jun 2001<br />Value:  300","Date: Jul 2001<br />Value:  296","Date: Aug 2001<br />Value:  292","Date: Sep 2001<br />Value:  290","Date: Oct 2001<br />Value:  286","Date: Nov 2001<br />Value:  293","Date: Dec 2001<br />Value:  324","Date: Jan 2002<br />Value:  288","Date: Feb 2002<br />Value:  296","Date: Mar 2002<br />Value:  322","Date: Apr 2002<br />Value:  290","Date: May 2002<br />Value:  310","Date: Jun 2002<br />Value:  304","Date: Jul 2002<br />Value:  303","Date: Aug 2002<br />Value:  305","Date: Sep 2002<br />Value:  320","Date: Oct 2002<br />Value:  316","Date: Nov 2002<br />Value:  319","Date: Dec 2002<br />Value:  353","Date: Jan 2003<br />Value:  320","Date: Feb 2003<br />Value:  298","Date: Mar 2003<br />Value:  313","Date: Apr 2003<br />Value:  223","Date: May 2003<br />Value:  257","Date: Jun 2003<br />Value:  274","Date: Jul 2003<br />Value:  284","Date: Aug 2003<br />Value:  298","Date: Sep 2003<br />Value:  312","Date: Oct 2003<br />Value:  326","Date: Nov 2003<br />Value:  324","Date: Dec 2003<br />Value:  345","Date: Jan 2004<br />Value:  321","Date: Feb 2004<br />Value:  305","Date: Mar 2004<br />Value:  315","Date: Apr 2004<br />Value:  292","Date: May 2004<br />Value:  313","Date: Jun 2004<br />Value:  308","Date: Jul 2004<br />Value:  313","Date: Aug 2004<br />Value:  295","Date: Sep 2004<br />Value:  321","Date: Oct 2004<br />Value:  325","Date: Nov 2004<br />Value:  320","Date: Dec 2004<br />Value:  356","Date: Jan 2005<br />Value:  330","Date: Feb 2005<br />Value:  333","Date: Mar 2005<br />Value:  333","Date: Apr 2005<br />Value:  319","Date: May 2005<br />Value:  339","Date: Jun 2005<br />Value:  335","Date: Jul 2005<br />Value:  351","Date: Aug 2005<br />Value:  350","Date: Sep 2005<br />Value:  337","Date: Oct 2005<br />Value:  337","Date: Nov 2005<br />Value:  344","Date: Dec 2005<br />Value:  390","Date: Jan 2006<br />Value:  363","Date: Feb 2006<br />Value:  366","Date: Mar 2006<br />Value:  361","Date: Apr 2006<br />Value:  351","Date: May 2006<br />Value:  374","Date: Jun 2006<br />Value:  363","Date: Jul 2006<br />Value:  379","Date: Aug 2006<br />Value:  374","Date: Sep 2006<br />Value:  366","Date: Oct 2006<br />Value:  376","Date: Nov 2006<br />Value:  379","Date: Dec 2006<br />Value:  421","Date: Jan 2007<br />Value:  378","Date: Feb 2007<br />Value:  384","Date: Mar 2007<br />Value:  400","Date: Apr 2007<br />Value:  375","Date: May 2007<br />Value:  400","Date: Jun 2007<br />Value:  411","Date: Jul 2007<br />Value:  412","Date: Aug 2007<br />Value:  421","Date: Sep 2007<br />Value:  408","Date: Oct 2007<br />Value:  415","Date: Nov 2007<br />Value:  420","Date: Dec 2007<br />Value:  473","Date: Jan 2008<br />Value:  417","Date: Feb 2008<br />Value:  448","Date: Mar 2008<br />Value:  436","Date: Apr 2008<br />Value:  420","Date: May 2008<br />Value:  458","Date: Jun 2008<br />Value:  444","Date: Jul 2008<br />Value:  456","Date: Aug 2008<br />Value:  459","Date: Sep 2008<br />Value:  452","Date: Oct 2008<br />Value:  481","Date: Nov 2008<br />Value:  471","Date: Dec 2008<br />Value:  510","Date: Jan 2009<br />Value:  486","Date: Feb 2009<br />Value:  440","Date: Mar 2009<br />Value:  470","Date: Apr 2009<br />Value:  458","Date: May 2009<br />Value:  487","Date: Jun 2009<br />Value:  481","Date: Jul 2009<br />Value:  490","Date: Aug 2009<br />Value:  501","Date: Sep 2009<br />Value:  490","Date: Oct 2009<br />Value:  509","Date: Nov 2009<br />Value:  502","Date: Dec 2009<br />Value:  564","Date: Jan 2010<br />Value:  527","Date: Feb 2010<br />Value:  531","Date: Mar 2010<br />Value:  530","Date: Apr 2010<br />Value:  528","Date: May 2010<br />Value:  568","Date: Jun 2010<br />Value:  547","Date: Jul 2010<br />Value:  564","Date: Aug 2010<br />Value:  561","Date: Sep 2010<br />Value:  561","Date: Oct 2010<br />Value:  590","Date: Nov 2010<br />Value:  580","Date: Dec 2010<br />Value:  639","Date: Jan 2011<br />Value:  613","Date: Feb 2011<br />Value:  601","Date: Mar 2011<br />Value:  611","Date: Apr 2011<br />Value:  610","Date: May 2011<br />Value:  650","Date: Jun 2011<br />Value:  647","Date: Jul 2011<br />Value:  672","Date: Aug 2011<br />Value:  645","Date: Sep 2011<br />Value:  648","Date: Oct 2011<br />Value:  674","Date: Nov 2011<br />Value:  668","Date: Dec 2011<br />Value:  740","Date: Jan 2012<br />Value:  734","Date: Feb 2012<br />Value:  670","Date: Mar 2012<br />Value:  712","Date: Apr 2012<br />Value:  699","Date: May 2012<br />Value:  721","Date: Jun 2012<br />Value:  726","Date: Jul 2012<br />Value:  734","Date: Aug 2012<br />Value:  726","Date: Sep 2012<br />Value:  716","Date: Oct 2012<br />Value:  732","Date: Nov 2012<br />Value:  729","Date: Dec 2012<br />Value:  792","Date: Jan 2013<br />Value:  735","Date: Feb 2013<br />Value:  740","Date: Mar 2013<br />Value:  768","Date: Apr 2013<br />Value:  735","Date: May 2013<br />Value:  768","Date: Jun 2013<br />Value:  780","Date: Jul 2013<br />Value:  773","Date: Aug 2013<br />Value:  772","Date: Sep 2013<br />Value:  763","Date: Oct 2013<br />Value:  778","Date: Nov 2013<br />Value:  774","Date: Dec 2013<br />Value:  840","Date: Jan 2014<br />Value:  836","Date: Feb 2014<br />Value:  777","Date: Mar 2014<br />Value:  802","Date: Apr 2014<br />Value:  772","Date: May 2014<br />Value:  830","Date: Jun 2014<br />Value:  803","Date: Jul 2014<br />Value:  807","Date: Aug 2014<br />Value:  857","Date: Sep 2014<br />Value:  811","Date: Oct 2014<br />Value:  849","Date: Nov 2014<br />Value:  824","Date: Dec 2014<br />Value:  889","Date: Jan 2015<br />Value:  827","Date: Feb 2015<br />Value:  829","Date: Mar 2015<br />Value:  819","Date: Apr 2015<br />Value:  779","Date: May 2015<br />Value:  827","Date: Jun 2015<br />Value:  781","Date: Jul 2015<br />Value:  818","Date: Aug 2015<br />Value:  844","Date: Sep 2015<br />Value:  808","Date: Oct 2015<br />Value:  835","Date: Nov 2015<br />Value:  807","Date: Dec 2015<br />Value:  858","Date: Jan 2016<br />Value:  844","Date: Feb 2016<br />Value:  843","Date: Mar 2016<br />Value:  832","Date: Apr 2016<br />Value:  816","Date: May 2016<br />Value:  856","Date: Jun 2016<br />Value:  807","Date: Jul 2016<br />Value:  873","Date: Aug 2016<br />Value:  846","Date: Sep 2016<br />Value:  860","Date: Oct 2016<br />Value:  865","Date: Nov 2016<br />Value:  818","Date: Dec 2016<br />Value:  877","Date: Jan 2017<br />Value:  931","Date: Feb 2017<br />Value:  839","Date: Mar 2017<br />Value:  839","Date: Apr 2017<br />Value:  813","Date: May 2017<br />Value:  828","Date: Jun 2017<br />Value:  800","Date: Jul 2017<br />Value:  859","Date: Aug 2017<br />Value:  861","Date: Sep 2017<br />Value:  850","Date: Oct 2017<br />Value:  860","Date: Nov 2017<br />Value:  842","Date: Dec 2017<br />Value:  906","Date: Jan 2018<br />Value:  834","Date: Feb 2018<br />Value:  898","Date: Mar 2018<br />Value:  887","Date: Apr 2018<br />Value:  824","Date: May 2018<br />Value:  857","Date: Jun 2018<br />Value:  845","Date: Jul 2018<br />Value:  874","Date: Aug 2018<br />Value:  910","Date: Sep 2018<br />Value:  870","Date: Oct 2018<br />Value:  877","Date: Nov 2018<br />Value:  873","Date: Dec 2018<br />Value:  947","Date: Jan 2019<br />Value:  889","Date: Feb 2019<br />Value:  883","Date: Mar 2019<br />Value:  893","Date: Apr 2019<br />Value:  847","Date: May 2019<br />Value:  867","Date: Jun 2019<br />Value:  885","Date: Jul 2019<br />Value:  900","Date: Aug 2019<br />Value:  944","Date: Sep 2019<br />Value:  913","Date: Oct 2019<br />Value:  926","Date: Nov 2019<br />Value:  937","Date: Dec 2019<br />Value:  993","Date: Jan 2020<br />Value: 1007","Date: Feb 2020<br />Value:  767","Date: Mar 2020<br />Value:  720","Date: Apr 2020<br />Value:  428","Date: May 2020<br />Value:  453","Date: Jun 2020<br />Value:  531","Date: Jul 2020<br />Value:  724","Date: Aug 2020<br />Value:  729","Date: Sep 2020<br />Value:  694","Date: Oct 2020<br />Value:  747","Date: Nov 2020<br />Value:  760","Date: Dec 2020<br />Value:  860","Date: Jan 2021<br />Value:  776","Date: Feb 2021<br />Value:  754","Date: Mar 2021<br />Value:  784","Date: Apr 2021<br />Value:  743","Date: May 2021<br />Value:  658","Date: Jun 2021<br />Value:  562","Date: Jul 2021<br />Value:  667","Date: Aug 2021<br />Value:  666","Date: Sep 2021<br />Value:  708","Date: Oct 2021<br />Value:  694","Date: Nov 2021<br />Value:  743","Date: Dec 2021<br />Value:  896","Date: Jan 2022<br />Value:  826","Date: Feb 2022<br />Value:  731","Date: Mar 2022<br />Value:  801","Date: Apr 2022<br />Value:  811","Date: May 2022<br />Value:  902","Date: Jun 2022<br />Value:  878","Date: Jul 2022<br />Value:  931","Date: Aug 2022<br />Value:  918","Date: Sep 2022<br />Value:  902","Date: Oct 2022<br />Value:  938","Date: Nov 2022<br />Value:  920","Date: Dec 2022<br />Value: 1007","Date: Jan 2023<br />Value:  999","Date: Feb 2023<br />Value:  881","Date: Mar 2023<br />Value:  935","Date: Apr 2023<br />Value:  928","Date: May 2023<br />Value:  976","Date: Jun 2023<br />Value:  938","Date: Jul 2023<br />Value:  988","Date: Aug 2023<br />Value:  994","Date: Sep 2023<br />Value:  963","Date: Oct 2023<br />Value:  959","Date: Nov 2023<br />Value:  934","Date: Dec 2023<br />Value: 1011","Date: Jan 2024<br />Value:  942"],"type":"scatter","mode":"lines+markers","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":3.7795275590551185,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826498,"l":48.949771689497723},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Food and Beverage Sales Value From Jan 2000-Jan 2024","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1998.8,2025.2],"tickmode":"array","ticktext":["Jan 2000","Jan 2005","Jan 2010","Jan 2015","Jan 2020","Jan 2025"],"tickvals":[2000,2005,2010,2015,2020,2025],"categoryorder":"array","categoryarray":["Jan 2000","Jan 2005","Jan 2010","Jan 2015","Jan 2020","Jan 2025"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Date","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[183.59999999999999,1050.4000000000001],"tickmode":"array","ticktext":["200","400","600","800","1000"],"tickvals":[200,400,600,800,1000],"categoryorder":"array","categoryarray":["200","400","600","800","1000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Sales (SGD)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"647533407380":{"x":{},"y":{},"type":"scatter"},"64754c5ef2c9":{"x":{},"y":{}}},"cur_data":"647533407380","visdat":{"647533407380":["function (y) ","x"],"64754c5ef2c9":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Visualization Insights:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p><strong>Trend</strong>: The trend is showing a definite increase in food and beverage sales value for the past 20+ years as time progresses, so it is safe to assume from the trends that it is going to always increase in the future disregarding external factors that might divert that assumption.</p></li>
<li><p><strong>Seasonality</strong>: From the line chart above, it can be observed that for the month of December of every year shows a upward spike of food and beverage sales. This might indicate seasonality or predictable changes for a specific time, which in this case is highly likely caused by <strong>Christmas holiday celebrations</strong> that is celebrated by majority of Singapore’s population.</p></li>
<li><p><strong>Outlier</strong>: An outlier can be seen during the COVID period of early 2020s to the end of 2020 where food and beverage sales value spikes all the way down by more than 50%.</p></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Interactivity Features:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p><strong>Data Points</strong>: You can hover over any data points to look at detailed information of specific month and year and the mean value.</p></li>
<li><p><strong>Pinch and Zoom</strong>: You can drag to zoom in certain period of time in the line chart to separate each data point more clearly.</p></li>
</ul>
</div>
</div>
</section>
<section id="time-series-analysis-and-nowcasting" class="level1">
<h1>Time Series Analysis and Nowcasting</h1>
<section id="nowcasting-model-linear-regression-simple" class="level2">
<h2 class="anchored" data-anchor-id="nowcasting-model-linear-regression-simple">Nowcasting Model: Linear Regression (Simple)</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Retail Sales</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Food and Beverage Sales</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>lm_sales_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Value <span class="sc">~</span> Date, <span class="at">data=</span>salesdata)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_sales_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Value ~ Date, data = salesdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-2018.84  -192.01     9.41   189.07   935.90 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -1.849e+05  5.928e+03  -31.18   &lt;2e-16 ***
Date         9.341e+01  2.946e+00   31.70   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 348.2 on 287 degrees of freedom
Multiple R-squared:  0.7779,    Adjusted R-squared:  0.7771 
F-statistic:  1005 on 1 and 287 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(salesdata<span class="sc">$</span>Date, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>     salesdata<span class="sc">$</span>Value, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Linear Regression Model Plot for Retail Sales Value"</span>, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Date"</span>, </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Sales"</span>, </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(lm_sales_model, <span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex04_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>lm_fnb_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Value <span class="sc">~</span> Date, <span class="at">data=</span>fnbdata)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_fnb_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Value ~ Date, data = fnbdata)

Residuals:
    Min      1Q  Median      3Q     Max 
-441.91  -61.12   -2.33   68.61  185.06 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -6.200e+04  1.616e+03  -38.37   &lt;2e-16 ***
Date         3.112e+01  8.032e-01   38.74   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 94.93 on 287 degrees of freedom
Multiple R-squared:  0.8395,    Adjusted R-squared:  0.8389 
F-statistic:  1501 on 1 and 287 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fnbdata<span class="sc">$</span>Date, </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>     fnbdata<span class="sc">$</span>Value, </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Linear Regression Model Plot for F&amp;B Sales Value"</span>, </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Date"</span>, </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Sales"</span>, </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(lm_fnb_model, <span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex04_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>Linear regression models can be very useful for understanding trends over time, but they have <strong>limitations</strong>. They assume a linear relationship between predictors and the target variable, do not capture seasonal or cyclic patterns unless explicitly modeled, and can be sensitive to outliers. For time series data that exhibits seasonality, trends, and irregular cycles, more complex models might provide better accuracy. Thus, I decided to use ARIMA (Autoregressive Integrated Moving Average) as my chosen type of nowcasting model as it is useful for capturing various statistical properties in a time series data.</p>
</section>
<section id="nowcasting-model-arima-autoregressive-integrated-moving-average" class="level2">
<h2 class="anchored" data-anchor-id="nowcasting-model-arima-autoregressive-integrated-moving-average">Nowcasting Model: ARIMA (Autoregressive Integrated Moving Average)</h2>
<section id="converting-dataframe-to-time-series" class="level3">
<h3 class="anchored" data-anchor-id="converting-dataframe-to-time-series">Converting Dataframe to Time Series</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>sales_ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(salesdata<span class="sc">$</span>Value, <span class="at">start=</span><span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), <span class="at">frequency=</span><span class="dv">12</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>fnb_ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(fnbdata<span class="sc">$</span>Value, <span class="at">start=</span><span class="fu">c</span>(<span class="dv">2000</span>,<span class="dv">1</span>), <span class="at">frequency=</span><span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Retail Sales</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">F&amp;B Sales</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sales_ts, <span class="at">xlab=</span><span class="st">"Year"</span>, <span class="at">ylab=</span><span class="st">"Sales"</span>, <span class="at">main=</span><span class="st">"Retail Sales Line Chart"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex04_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>sales_fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(sales_ts)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># You can inspect the chosen model</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sales_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: sales_ts 
ARIMA(3,0,1)(2,1,2)[12] with drift 

Coefficients:
         ar1      ar2     ar3      ma1     sar1     sar2     sma1     sma2
      1.4831  -0.6103  0.1041  -0.7311  -0.7918  -0.2756  -0.0724  -0.4516
s.e.  0.1180   0.1239  0.0690   0.1041   0.1223   0.0824   0.1221   0.1049
       drift
      7.3958
s.e.  2.1517

sigma^2 = 24643:  log likelihood = -1796.14
AIC=3612.27   AICc=3613.1   BIC=3648.52

Training set error measures:
                     ME     RMSE      MAE        MPE     MAPE      MASE
Training set -0.3146969 151.1707 102.7402 -0.2428979 3.577741 0.5343317
                     ACF1
Training set -0.005350747</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>input_h <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>sales_forecast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(sales_fit, <span class="at">h=</span>input_h)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fnb_ts, <span class="at">xlab=</span><span class="st">"Year"</span>, <span class="at">ylab=</span><span class="st">"Sales"</span>, <span class="at">main=</span><span class="st">"F&amp;B Sales Line Chart"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex04_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>fnb_fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(fnb_ts)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># You can inspect the chosen model</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fnb_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: fnb_ts 
ARIMA(0,1,0)(2,0,0)[12] 

Coefficients:
        sar1    sar2
      0.3465  0.2383
s.e.  0.0561  0.0576

sigma^2 = 1461:  log likelihood = -1459.03
AIC=2924.06   AICc=2924.15   BIC=2935.05

Training set error measures:
                    ME     RMSE      MAE       MPE     MAPE      MASE
Training set 0.9425747 38.02115 22.71381 -0.014856 3.799937 0.4091114
                    ACF1
Training set -0.09047178</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>input_h <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>fnb_forecast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fnb_fit, <span class="at">h=</span>input_h)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Using an 80% confidence interval for forecasting, including in the context of ARIMA models, is a choice that balances the need for precision and the acceptance of uncertainty in the forecast. The code chunk below is to show the forecasted values in the next 1 year.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>sales_forecast_values <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date =</span> <span class="fu">as.Date</span>(sales_forecast<span class="sc">$</span>mean),</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">as.numeric</span>(sales_forecast<span class="sc">$</span>mean),</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lower =</span> <span class="fu">as.numeric</span>(sales_forecast<span class="sc">$</span>lower[, <span class="st">"80%"</span>]),</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Upper =</span> <span class="fu">as.numeric</span>(sales_forecast<span class="sc">$</span>upper[, <span class="st">"80%"</span>])</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>fnb_forecast_values <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date =</span> <span class="fu">as.Date</span>(fnb_forecast<span class="sc">$</span>mean),</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">as.numeric</span>(fnb_forecast<span class="sc">$</span>mean),</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lower =</span> <span class="fu">as.numeric</span>(fnb_forecast<span class="sc">$</span>lower[, <span class="st">"80%"</span>]),</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Upper =</span> <span class="fu">as.numeric</span>(fnb_forecast<span class="sc">$</span>upper[, <span class="st">"80%"</span>])</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Retail Sales</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">F&amp;B Sales</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>salesdata<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(salesdata<span class="sc">$</span>Date)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(<span class="at">data =</span> salesdata, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>Value, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines+markers'</span>, <span class="at">name =</span> <span class="st">'Observed'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(<span class="at">data =</span> sales_forecast_values, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>Value, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines+markers'</span>, <span class="at">name =</span> <span class="st">'Forecasted'</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">dash =</span> <span class="st">'dot'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_ribbons</span>(<span class="at">data =</span> sales_forecast_values, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">ymin =</span> <span class="sc">~</span>Lower, <span class="at">ymax =</span> <span class="sc">~</span>Upper, <span class="at">name =</span> <span class="st">'Confidence Interval'</span>, <span class="at">fillcolor =</span> <span class="st">'rgba(255, 0, 0, 0.2)'</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'transparent'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">'Feb 2024 - Jan 2025 Retail Sales Value Nowcasted with ARIMA'</span>,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Date'</span>),</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Value (SGD)'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-ef22f4400f861576bb9e" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-ef22f4400f861576bb9e">{"x":{"visdat":{"647538f43356":["function () ","plotlyVisDat"],"647528567050":["function () ","data"],"647542e7a8e0":["function () ","data"],"647577002c70":["function () ","data"]},"cur_data":"647577002c70","attrs":{"647528567050":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines+markers","name":"Observed","inherit":true},"647542e7a8e0":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines+markers","name":"Forecasted","line":{"dash":"dot"},"inherit":true},"647577002c70":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"ymin":{},"ymax":{},"type":"scatter","mode":"lines","hoveron":"points","fill":"toself","name":"Confidence Interval","fillcolor":"rgba(255, 0, 0, 0.2)","line":{"color":"transparent"},"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Feb 2024 - Jan 2025 Retail Sales Value Nowcasted with ARIMA","xaxis":{"domain":[0,1],"automargin":true,"title":"Date"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Value (SGD)"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["2000-01-01","2000-02-01","2000-03-01","2000-04-01","2000-05-01","2000-06-01","2000-07-01","2000-08-01","2000-09-01","2000-10-01","2000-11-01","2000-12-01","2001-01-01","2001-02-01","2001-03-01","2001-04-01","2001-05-01","2001-06-01","2001-07-01","2001-08-01","2001-09-01","2001-10-01","2001-11-01","2001-12-01","2002-01-01","2002-02-01","2002-03-01","2002-04-01","2002-05-01","2002-06-01","2002-07-01","2002-08-01","2002-09-01","2002-10-01","2002-11-01","2002-12-01","2003-01-01","2003-02-01","2003-03-01","2003-04-01","2003-05-01","2003-06-01","2003-07-01","2003-08-01","2003-09-01","2003-10-01","2003-11-01","2003-12-01","2004-01-01","2004-02-01","2004-03-01","2004-04-01","2004-05-01","2004-06-01","2004-07-01","2004-08-01","2004-09-01","2004-10-01","2004-11-01","2004-12-01","2005-01-01","2005-02-01","2005-03-01","2005-04-01","2005-05-01","2005-06-01","2005-07-01","2005-08-01","2005-09-01","2005-10-01","2005-11-01","2005-12-01","2006-01-01","2006-02-01","2006-03-01","2006-04-01","2006-05-01","2006-06-01","2006-07-01","2006-08-01","2006-09-01","2006-10-01","2006-11-01","2006-12-01","2007-01-01","2007-02-01","2007-03-01","2007-04-01","2007-05-01","2007-06-01","2007-07-01","2007-08-01","2007-09-01","2007-10-01","2007-11-01","2007-12-01","2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01"],"y":[2383,1565,1909,1914,1952,2117,2098,1925,2005,1796,2002,2240,2252,1696,2042,1793,1846,1850,1797,1870,1691,1698,1822,2111,2090,1665,2019,1822,1766,1835,1973,1846,1793,1835,1977,2388,2421,1565,1930,1831,2029,1946,2072,1890,1940,1998,2082,2510,2442,2106,2248,2053,2138,2242,2214,2064,2131,2262,2330,2612,2778,2078,2558,2350,2363,2486,2516,2341,2425,2599,2450,2914,3016,2181,2858,2545,2697,2622,2615,2425,2513,2657,2681,3094,3044,2640,2773,2619,2813,3079,2619,2645,2744,2838,2741,3239,3342,2642,2954,2844,2986,3001,2958,2797,2999,2812,2742,3335,3076,2616,2893,2664,2828,2904,2828,2817,2786,2821,2826,3306,3174,2733,2877,2658,2726,2764,2845,2848,2896,2896,2979,3552,3441,2553,3071,3063,3187,3275,3362,3138,3072,3329,3316,3865,3660,3165,3443,3214,3279,3315,3331,3324,3232,3379,3374,3941,3730,3226,3362,3389,3585,3383,3261,3272,3234,3243,3266,3935,4028,3081,3494,3237,3461,3424,3450,3451,3350,3537,3482,4119,3800,3499,3526,3353,3610,3613,3574,3626,3448,3603,3624,4223,4110,3435,3754,3513,3783,3734,3746,3676,3578,3740,3707,4306,4270,3386,3847,3543,3791,3783,3775,3774,3548,3735,3892,4569,3948,3676,3813,3591,3808,3863,3697,3777,3631,3773,3841,4331,4286,3351,3828,3565,3778,3556,3674,3648,3583,3638,3701,4210,4022,3090,3329,2156,1840,2594,3384,3473,3238,3369,3699,4137,3827,3322,3609,3397,3398,3354,3462,3450,3519,3681,3831,4455,4319,3213,3931,3800,3994,3835,3926,3877,3881,4039,4055,4767,4238,3591,4082,3920,4049,3865,3976,4041,3906,4021,4137,4745,4294],"type":"scatter","mode":"lines+markers","name":"Observed","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01","2024-12-01","2025-01-01"],"y":[3649.5794643880809,4067.5196407440949,3821.5731068501645,3925.8092594036666,3882.3490879524165,3996.446040735319,3999.4341961936689,3948.1665352118916,4082.1231855251326,4193.9458885740623,4788.8994469563349,4534.5777085033824],"type":"scatter","mode":"lines+markers","name":"Forecasted","line":{"color":"rgba(255,127,14,1)","dash":"dot"},"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(255, 0, 0, 0.2)","x":["2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01","2024-12-01","2025-01-01","2025-01-01","2025-01-01","2024-12-01","2024-11-01","2024-10-01","2024-09-01","2024-08-01","2024-07-01","2024-06-01","2024-05-01","2024-04-01","2024-03-01","2024-02-01"],"type":"scatter","mode":"lines","hoveron":"points","fill":"toself","name":"Confidence Interval","line":{"color":"transparent"},"y":[3448.3993171443913,3815.8095266254154,3550.1428335671303,3643.0458218619769,3590.7365002523829,3697.0241383815828,3692.9327742952637,3635.2388352770454,3763.3685150423871,3869.9055299083125,4460.0579964560575,4201.3686191748748,4201.3686191748748,4867.78679783189,5117.7408974566124,4517.9862472398117,4400.8778560078781,4261.0942351467384,4305.935618092074,4295.8679430890552,4173.9616756524501,4208.5726969453563,4093.0033801331988,4319.2297548627739,3850.7596116317704],"marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>fnbdata<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(fnbdata<span class="sc">$</span>Date)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>() <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(<span class="at">data =</span> fnbdata, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>Value, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines+markers'</span>, <span class="at">name =</span> <span class="st">'Observed'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(<span class="at">data =</span> fnb_forecast_values, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>Value, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines+markers'</span>, <span class="at">name =</span> <span class="st">'Forecasted'</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">dash =</span> <span class="st">'dot'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_ribbons</span>(<span class="at">data =</span> fnb_forecast_values, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">ymin =</span> <span class="sc">~</span>Lower, <span class="at">ymax =</span> <span class="sc">~</span>Upper, <span class="at">name =</span> <span class="st">'Confidence Interval'</span>, <span class="at">fillcolor =</span> <span class="st">'rgba(255, 0, 0, 0.2)'</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'transparent'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">'Feb 2024 - Jan 2025 F&amp;B Sales Value Nowcasted with ARIMA'</span>,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Date'</span>),</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Value (SGD)'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-62d1f78325e94926475d" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-62d1f78325e94926475d">{"x":{"visdat":{"647546826614":["function () ","plotlyVisDat"],"64751afbcf36":["function () ","data"],"64759e0f011":["function () ","data"],"6475eb0f128":["function () ","data"]},"cur_data":"6475eb0f128","attrs":{"64751afbcf36":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines+markers","name":"Observed","inherit":true},"64759e0f011":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines+markers","name":"Forecasted","line":{"dash":"dot"},"inherit":true},"6475eb0f128":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"ymin":{},"ymax":{},"type":"scatter","mode":"lines","hoveron":"points","fill":"toself","name":"Confidence Interval","fillcolor":"rgba(255, 0, 0, 0.2)","line":{"color":"transparent"},"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Feb 2024 - Jan 2025 F&B Sales Value Nowcasted with ARIMA","xaxis":{"domain":[0,1],"automargin":true,"title":"Date"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Value (SGD)"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["2000-01-01","2000-02-01","2000-03-01","2000-04-01","2000-05-01","2000-06-01","2000-07-01","2000-08-01","2000-09-01","2000-10-01","2000-11-01","2000-12-01","2001-01-01","2001-02-01","2001-03-01","2001-04-01","2001-05-01","2001-06-01","2001-07-01","2001-08-01","2001-09-01","2001-10-01","2001-11-01","2001-12-01","2002-01-01","2002-02-01","2002-03-01","2002-04-01","2002-05-01","2002-06-01","2002-07-01","2002-08-01","2002-09-01","2002-10-01","2002-11-01","2002-12-01","2003-01-01","2003-02-01","2003-03-01","2003-04-01","2003-05-01","2003-06-01","2003-07-01","2003-08-01","2003-09-01","2003-10-01","2003-11-01","2003-12-01","2004-01-01","2004-02-01","2004-03-01","2004-04-01","2004-05-01","2004-06-01","2004-07-01","2004-08-01","2004-09-01","2004-10-01","2004-11-01","2004-12-01","2005-01-01","2005-02-01","2005-03-01","2005-04-01","2005-05-01","2005-06-01","2005-07-01","2005-08-01","2005-09-01","2005-10-01","2005-11-01","2005-12-01","2006-01-01","2006-02-01","2006-03-01","2006-04-01","2006-05-01","2006-06-01","2006-07-01","2006-08-01","2006-09-01","2006-10-01","2006-11-01","2006-12-01","2007-01-01","2007-02-01","2007-03-01","2007-04-01","2007-05-01","2007-06-01","2007-07-01","2007-08-01","2007-09-01","2007-10-01","2007-11-01","2007-12-01","2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01"],"y":[294,292,307,297,318,309,312,309,337,324,334,359,319,293,316,284,305,300,296,292,290,286,293,324,288,296,322,290,310,304,303,305,320,316,319,353,320,298,313,223,257,274,284,298,312,326,324,345,321,305,315,292,313,308,313,295,321,325,320,356,330,333,333,319,339,335,351,350,337,337,344,390,363,366,361,351,374,363,379,374,366,376,379,421,378,384,400,375,400,411,412,421,408,415,420,473,417,448,436,420,458,444,456,459,452,481,471,510,486,440,470,458,487,481,490,501,490,509,502,564,527,531,530,528,568,547,564,561,561,590,580,639,613,601,611,610,650,647,672,645,648,674,668,740,734,670,712,699,721,726,734,726,716,732,729,792,735,740,768,735,768,780,773,772,763,778,774,840,836,777,802,772,830,803,807,857,811,849,824,889,827,829,819,779,827,781,818,844,808,835,807,858,844,843,832,816,856,807,873,846,860,865,818,877,931,839,839,813,828,800,859,861,850,860,842,906,834,898,887,824,857,845,874,910,870,877,873,947,889,883,893,847,867,885,900,944,913,926,937,993,1007,767,720,428,453,531,724,729,694,747,760,860,776,754,784,743,658,562,667,666,708,694,743,896,826,731,801,811,902,878,931,918,902,938,920,1007,999,881,935,928,976,938,988,994,963,959,934,1011,942],"type":"scatter","mode":"lines+markers","name":"Observed","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01","2024-12-01","2025-01-01"],"y":[878.48033922690956,913.86941608978907,913.82711456126822,952.14154395982644,933.25716201248611,963.20946718021855,962.19043895910318,947.63758824805132,954.8302151368863,941.87953213724359,989.28808519709537,963.47614979695652],"type":"scatter","mode":"lines+markers","name":"Forecasted","line":{"color":"rgba(255,127,14,1)","dash":"dot"},"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(255, 0, 0, 0.2)","x":["2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01","2024-12-01","2025-01-01","2025-01-01","2025-01-01","2024-12-01","2024-11-01","2024-10-01","2024-09-01","2024-08-01","2024-07-01","2024-06-01","2024-05-01","2024-04-01","2024-03-01","2024-02-01"],"type":"scatter","mode":"lines","hoveron":"points","fill":"toself","name":"Confidence Interval","line":{"color":"transparent"},"y":[829.49938870132439,844.59989155858102,828.98961964793727,854.17964290865609,823.73242703472363,843.23113127602744,832.59902488884643,809.0985391856351,807.88736356013078,786.98816651637298,826.83665042876828,793.80115997029452,793.80115997029452,1133.1511396236185,1151.7395199654225,1096.7708977581142,1101.7730667136418,1086.1766373104674,1091.78185302936,1083.1878030844098,1042.7818969902485,1050.1034450109967,998.66460947459916,983.13894062099712,927.46128975249474],"marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="shiny-storyboarding" class="level1">
<h1>Shiny Storyboarding</h1>
<section id="section-1-historical" class="level2">
<h2 class="anchored" data-anchor-id="section-1-historical">Section 1: Historical</h2>
<p><img src="images/UI-Historical.png" class="img-fluid" width="781"></p>
<section id="ui-components" class="level3">
<h3 class="anchored" data-anchor-id="ui-components">UI Components</h3>
<ul>
<li><strong>Title and Tabs:</strong></li>
</ul>
<p>Utilize <code>navbarPage</code> or <code>tabsetPanel</code> to create multiple tabs for “HISTORICAL” and “NOWCAST” data views. Use <code>titlePanel</code> for the main title “NOWCASTING STATE OF ECONOMIC IN SINGAPORE”.</p>
<ul>
<li><strong>Sidebar for Input Selection:</strong></li>
</ul>
<p>Include a <code>sidebarPanel</code> for user inputs. Use <code>selectInput</code> for dropdowns to select the dataset, the start year, and the end year of the analysis. Apply <code>dateInput</code> or a combination of <code>numericInput</code> / <code>selectInput</code> if you need users to select specific months and years. Incorporate an <code>actionButton</code> labeled “Submit” to trigger the data processing and visualization.</p>
<ul>
<li><strong>Main Panel for Data Display:</strong></li>
</ul>
<p>Employ a <code>mainPanel</code> to display the plot and any text outputs. Use <code>plotOutput</code> to present the time series plot of the selected dataset. Implement <code>textOutput</code> or <code>verbatimTextOutput</code> to show any textual data or results from the server calculations.</p>
</section>
<section id="server-design" class="level3">
<h3 class="anchored" data-anchor-id="server-design">Server Design</h3>
<ul>
<li><strong>Data Processing and Reactive Elements:</strong></li>
</ul>
<p>Read in the datasets and prepare them using reactive expressions that will update when new user inputs are provided. Use <code>reactive</code> or <code>reactiveVal</code> for processing and storing the dataset based on user input.</p>
<ul>
<li><strong>Subset Data Based on User Selection:</strong></li>
</ul>
<p>Create reactive subsets of the data using the <code>reactive</code> function based on the start and end year/month selected by the user.</p>
<ul>
<li><strong>Linear Regression Model and Forecasting:</strong></li>
</ul>
<p>Once the user clicks the “Submit” button, trigger the event using <code>eventReactive</code> to fit the linear model and calculate the forecast. Store the results of the model fitting and forecasting for use in the output.</p>
<ul>
<li><strong>Plotting:</strong></li>
</ul>
<p>Use <code>renderPlot</code> to create and display the plot based on the reactive data and model results. Include logic to add the linear regression line and any forecasted data points to the plot dynamically.</p>
<ul>
<li><strong>Output Display:</strong></li>
</ul>
<p>Output the plot and any textual data using output$YourOutputId &lt;- renderPlot({ … }) for plots or <code>renderText</code> for textual output.</p>
<ul>
<li><strong>Example Server Skeleton:</strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    data_reactive <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">observeEvent</span>(input<span class="sc">$</span>submit, {</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    output<span class="sc">$</span>timeseriesPlot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add other outputs like renderText for textual results</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="section-2-nowcasting" class="level2">
<h2 class="anchored" data-anchor-id="section-2-nowcasting">Section 2: Nowcasting</h2>
<p><img src="images/UI-Nowcasted.png" class="img-fluid" width="788"></p>
<section id="ui-components-1" class="level3">
<h3 class="anchored" data-anchor-id="ui-components-1">UI Components</h3>
<p>Having a lot of similarities with the Historical tab, I will focus more on the new components in the Nowcast tab:</p>
<ul>
<li><strong>Dropdown Inputs:</strong></li>
</ul>
<p><code>selectInput</code> for selecting the forecasting method, with ARIMA as one of the options.</p>
<ul>
<li><strong>Numeric Input:</strong></li>
</ul>
<p><code>numericInput</code> for “Forecast duration” where users can input the number of periods they want to forecast into the future.</p>
</section>
<section id="server-logic" class="level3">
<h3 class="anchored" data-anchor-id="server-logic">Server Logic</h3>
<ul>
<li><strong>Reactive Data Subset:</strong></li>
</ul>
<p>Reactive expressions that subset the data according to the user’s selected start and end year.</p>
<ul>
<li><strong>ARIMA Model Fitting and Forecasting:</strong></li>
</ul>
<p>Upon clicking “Submit”, use <code>eventReactive</code> to fit the ARIMA model to the subset data. Implement forecasting logic within <code>eventReactive</code> to generate nowcasts for the specified forecast duration.</p>
<ul>
<li><strong>Dynamic Plotting:</strong></li>
</ul>
<p>Use <code>renderPlot</code> to render the time series plot dynamically based on the input selections and the results of the ARIMA model. The plot should visually differentiate between historical and forecasted values.</p>
<ul>
<li><strong>Example Server Skeleton:</strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  data_reactive <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  forecast_reactive <span class="ot">&lt;-</span> <span class="fu">eventReactive</span>(input<span class="sc">$</span>submit, {</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>nowcastPlot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">data_reactive</span>()</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    forecasts <span class="ot">&lt;-</span> <span class="fu">forecast_reactive</span>()</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add other outputs like renderText for textual results</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>